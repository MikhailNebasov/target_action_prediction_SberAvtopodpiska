# Задача по предсказанию совершения пользователем целевого действия на сервисе СберАвтоподписка (классификация)

## 1. EDA  

[Датасет](https://drive.google.com/drive/folders/1rA4o6KHH-M2KMvBLHp5DZ5gioF2q7hZw) представлен двумя таблицами ga_hits.csv и ga_sessions.csv. Подробно о EDA информация содержится в файле eda.ypinb. 

## 2. Feature engeneering   

Датасет после обработки представлен только категориальными фичами. Однако использование OneHotEncoder() приводит к существенному использованию оперативной памяти и в пике требует более 100 Гб. В качестве компромисса был выбран TargetEncoder().  

## 3. Modeling  

В качестве моделей использовались LogisticRegression(), RandomForestClassifier(), MLPClassifier() из библиотеки scikit-learn. 

## 4. Evaluation 

LogisticRegression() - дала 0,6353 

RandomForestClassifier() - дала 0,6560 

MLPClassifier() - дала 0,66 

Дальнейшее экспериментирование с фичами на всех моделях приводило к ухудшению результатов. Настройка гиперпараметров позволяла получить незначительную прибавку для каждой из модели. Однако наилучший результат все равно приходился на MLPClassifier(). 

В итоге поскольку дальнейшего существенного роста не наблюдалось было принято решение остановиться на достигнутом.   

Наилучший результат был достигнут со следующими параметрами MLPClassifier(random_state=0, hidden_layer_sizes=(100, 50)) - 0,6666 

## 5. Выводы 

Способ предъявляет относительно невысокие требования к вычислительным ресурсам для решения поставленной задачи. Кросс-валидация на 5 фолдах выполняется менее чем за 20 минут на машине с Ryzen 5 5600X и 16 Гб оперативной памяти. 

Приведенный способ решения имеет недостаточно высокую точность, причина кроется прежде всего в данных, а именно слишком малое количество уникальных значений атрибутов по отношению к количеству данных. 

В итоге имеем, что степень корреляции очень низка, что подтверждается критерием корреляции Пирсона. Достижение более высокого результата видится проблематичным, хотя одна ошибка на три исхода, это неплохо. 

## 6. Итоги 

По итогам модель была сериализована и на ее основе реализован локальный веб-сервис, эмулирующий работу веб-сервиса. 

Файлы проекта: 

eda.ypinb - файл EDA.   

main.py - основной файл, выполняющий построение модели и ее сериализацию. 

web.py - файл, эмулирующий работу веб-сервиса, запускается после отработки main.py